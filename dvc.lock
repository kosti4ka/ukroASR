schema: '2.0'
stages:
  local_dict_train:
    cmd: /data/exp/kostya/ukroASR/prepare_dict.sh /data/exp/kostya/ukroASR/data/local/dict_train
      /data/exp/kostya/ukroASR/data/train/text
    deps:
    - path: artifacts/lexicon.txt
      md5: 090ee18d9b43fb3b3716646654fd3beb
      size: 101739868
    - path: data/train/text
      md5: fd6167178ad5b7fec50a417b012b2e33
      size: 5256661
    - path: prepare_dict.sh
      md5: b1541ee347a8fa15c91cf3631c849e0e
      size: 824
    outs:
    - path: data/local/dict_train/lexicon.txt
      md5: c7a06b8e8f7cafad579cf9587d0bf45c
      size: 2547474
    - path: data/local/dict_train/vocab
      md5: 450c28ed9837ec41e4225622b64b720f
      size: 1102993
  train_data_dir:
    cmd: python3.6 /data/exp/kostya/ukroASR/gen_data_dir.py /data/exp/kostya/ukroASR/data/raw_data/train.csv
      /data/exp/kostya/ukroASR/data/train
    deps:
    - path: data/raw_data/train.csv
      md5: 1a90ad03cf4be9b22f514c6f60b88627
      size: 6943859
    - path: gen_data_dir.py
      md5: 5ec044a51cc683be13f12cb9c87dd592
      size: 6883
    outs:
    - path: data/train/segments
      md5: 1782bccace656d3134777fd2b41ae53b
      size: 1245856
    - path: data/train/spk2utt
      md5: e6a8494aa8fdc54c379509ddffca41c2
      size: 736800
    - path: data/train/text
      md5: fd6167178ad5b7fec50a417b012b2e33
      size: 5256661
    - path: data/train/utt2spk
      md5: 1d7a301bf04db1409ad88670ab1beeeb
      size: 963692
    - path: data/train/wav.scp
      md5: e92118717037a94c94bef74b3fa2c4fe
      size: 3188
  lm_ukr_o3:
    cmd: cut -d' ' -f2- /data/exp/kostya/ukroASR/artifacts/text_plane                 /data/exp/kostya/ukroASR/artifacts/normal_fiction.txt                 /data/exp/kostya/ukroASR/artifacts/normal_news.txt                 /data/exp/kostya/ukroASR/artifacts/normal_wiki_dump.txt                 /data/exp/kostya/ukroASR/artifacts/normal_ubercorpus.txt
      > /tmp/train_corpus; ~/kenlm/build/bin/lmplz -o 3 --prune 6 8 10 </tmp/train_corpus
      | gzip -c > /data/exp/kostya/ukroASR/data/lm_ukr_o3.gz
    deps:
    - path: artifacts/normal_fiction.txt
      md5: ec1da4249355d6e39eccde5911b83b47
      size: 205467591
    - path: artifacts/normal_news.txt
      md5: 670377dc72912b1a57cb685dc8e666c1
      size: 5947306134
    - path: artifacts/normal_ubercorpus.txt
      md5: b0a5dffd6120dce3502e2ead36d1ab55
      size: 8502784005
    - path: artifacts/normal_wiki_dump.txt
      md5: 5a31c53d86c19b6c5fc9a6c67ad7b97d
      size: 2356960431
    - path: artifacts/text_plane
      md5: 3f9c322aa926e5701422d8521128ce12
      size: 49124558
    outs:
    - path: data/lm_ukr_o3.gz
      md5: 311b05b898c5a1c5cf6c4ed72b61a3d6
      size: 278423813
